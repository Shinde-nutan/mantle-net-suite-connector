<?xml version="1.0" encoding="UTF-8"?>
<entities xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/entity-definition-3.xsd">

    <entity entity-name="ProductPromo" package="org.apache.ofbiz.product.promo" group="ofbiz_transactional">
        <field name="productPromoId" type="id" is-pk="true"></field>
        <field name="promoName" type="text-medium"></field>
        <field name="promoText" type="text-medium"></field>
        <field name="userEntered" type="text-indicator"></field>
        <field name="showToCustomer" type="text-indicator"></field>
        <field name="requireCode" type="text-indicator"></field>
        <field name="useLimitPerOrder" type="number-integer"></field>
        <field name="useLimitPerCustomer" type="number-integer"></field>
        <field name="useLimitPerPromotion" type="number-integer"></field>
        <field name="billbackFactor" type="number-decimal"></field>
        <field name="overrideOrgPartyId" type="id"></field>
        <field name="createdDate" type="date-time"></field>
        <field name="createdByUserLogin" type="id-long"></field>
        <field name="lastModifiedDate" type="date-time"></field>
        <field name="lastModifiedByUserLogin" type="id-long"></field>
        <relationship type="one" fk-name="PROD_PRMO_OPA" related="org.apache.ofbiz.party.party.Party">
            <key-map field-name="overrideOrgPartyId" related="partyId"/>
        </relationship>
        <relationship type="one" fk-name="PROD_PRMO_CUL" title="CreatedBy" related="org.apache.ofbiz.security.login.UserLogin">
            <key-map field-name="createdByUserLogin" related="userLoginId"/>
        </relationship>
        <relationship type="one" fk-name="PROD_PRMO_LMCUL" title="LastModifiedBy" related="org.apache.ofbiz.security.login.UserLogin">
            <key-map field-name="lastModifiedByUserLogin" related="userLoginId"/>
        </relationship>
    </entity>

    <!-- we can shift this view into ofbiz-oms-udm component where all other generic views are created as CommunicationEventAndOrder view is not specific to netsuite. -->
    <view-entity entity-name="CommunicationEventAndOrder" package="co.hotwax.integration">
        <member-entity entity-alias="CO" entity-name="org.apache.ofbiz.order.order.CommunicationEventOrder"/>
        <member-entity entity-alias="CE" entity-name="org.apache.ofbiz.party.communication.CommunicationEvent" join-from-alias="CO">
            <key-map field-name="communicationEventId"/>
        </member-entity>
        <alias-all entity-alias="CO"/>
        <alias-all entity-alias="CE"/>
    </view-entity>
    <!-- View created for brokered order feed for order sync flow. -->

    <view-entity entity-name="BrokeredOrderItemsSyncQueueFastApproval" package="co.hotwax.warehouse">
        <description> View to get details for the brokered orders Items.</description>
        <member-entity entity-alias="OH" entity-name="org.apache.ofbiz.order.order.OrderHeader"/>
        <member-entity entity-alias="OI" entity-name="org.apache.ofbiz.order.order.OrderItem" join-from-alias="OH">
                <key-map field-name="orderId"/>
        </member-entity>
        <member-entity entity-alias="OIA" entity-name="org.apache.ofbiz.order.order.OrderItemAttribute" join-from-alias="OI">
            <key-map field-name="orderId"/>
            <key-map field-name="orderItemSeqId"/>
        </member-entity>
        <member-entity entity-alias="OISG" entity-name="org.apache.ofbiz.order.order.OrderItemShipGroup" join-from-alias="OI">
            <key-map field-name="orderId"/>
            <key-map field-name="shipGroupSeqId"/>
        </member-entity>
        <member-entity entity-alias="OISGINR" entity-name="org.apache.ofbiz.order.order.OrderItemShipGrpInvRes" join-from-alias="OI" join-optional="true">
                <key-map field-name="orderId"/>
                <key-map field-name="orderItemSeqId"/>
                <key-map field-name="shipGroupSeqId"/>
        </member-entity>
        <member-entity entity-alias="EFO" entity-name="co.hotwax.integration.order.ExternalFulfillmentOrderItem" join-from-alias="OI" join-optional="true">
            <key-map field-name="orderId"/>
            <key-map field-name="orderItemSeqId"/>
            <key-map field-name="shipGroupSeqId"/>
        </member-entity>
        <member-entity entity-alias="F" entity-name="org.apache.ofbiz.product.facility.Facility" join-from-alias="OISG">
            <key-map field-name="facilityId"/>
        </member-entity>
        <member-entity entity-alias="FT"  entity-name="org.apache.ofbiz.product.facility.FacilityType" join-from-alias="F">
            <key-map field-name="facilityTypeId"/>
        </member-entity>
        <member-entity entity-alias="ODR" entity-name="org.apache.ofbiz.order.order.OrderRole" join-from-alias="OH" join-optional="true">
            <key-map field-name="orderId"/>
        </member-entity>
        <member-entity entity-alias="PD" entity-name="org.apache.ofbiz.product.product.Product" join-from-alias="OI">
            <key-map field-name="productId"/>
        </member-entity>
        <member-entity entity-alias="GI" entity-name="org.apache.ofbiz.product.product.GoodIdentification" join-from-alias="PD" join-optional="true">
            <key-map field-name="productId"/>
        </member-entity>
        <alias entity-alias="OIA" name="attrValue"/>
        <alias entity-alias="OH" field="orderId" name="externalId"/>
        <alias entity-alias="OI" field="orderItemSeqId" name="itemSeqId"/>
        <alias entity-alias="OI" field="quantity" name="orderItemQuantity"/>
        <alias entity-alias="OISG" name="shipmentMethodTypeId"/>
        <alias entity-alias="GI" name="idValue"/>
        <alias entity-alias="OH" name="entryDate"/>
        <!--        <alias entity-alias="OI" field="closed" name="closed"/>-->
        <alias entity-alias="OISGINR" field="quantity" name="quantity"/>
        <alias entity-alias="F" field="externalId" name="location"/>
        <alias entity-alias="OISG" field="contactMechId" name="postalContactMech"/>
        <entity-condition>
            <econditions combine="and">
                <econdition entity-alias="OH" field-name="orderTypeId" operator="equals" value="SALES_ORDER"/>
                <econdition entity-alias="FT" field-name="parentTypeId" operator="not-equals" value="VIRTUAL_FACILITY"/>
                <econdition entity-alias="OIA" field-name="attrName"operator="equals" value="NetsuiteItemLineId"/>
                <econdition entity-alias="OIA" field-name="attrValue" operator="equals" value=""/>
                <econdition entity-alias="GI" field-name="goodIdentificationTypeId" operator="equals" value="ERP_ID"/>
                <econditions combine="or">
                    <econdition entity-alias="EFO" field-name="fulfillmentStatus" operator="equals" value="REJECT"/>
                    <econdition entity-alias="EFO" field-name="fulfillmentStatus" operator="equals" value=""/>
                </econditions>
                <econditions combine="or">
                <econdition entity-alias="OI" field-name="quantity" operator="greater" to-entity-alias="OI" to-field-name="cancelQuantity"/>
                <econdition entity-alias="OI" field-name="cancelQuantity" operator="equals" value=""/>
            </econditions>
                <econdition entity-alias="ODR" field-name="roleTypeId" operator="equals" value="BILL_TO_CUSTOMER"/>
            </econditions>
        <order-by field-name="entryDate"/>
        </entity-condition>
    </view-entity>
</entities>